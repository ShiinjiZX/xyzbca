<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node.js Web Terminal - Professional Panel</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
        .context-menu {
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }
        .file-tree-item:hover {
            background: rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Icons
        const Terminal = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="4 17 10 11 4 5"></polyline>
                <line x1="12" y1="19" x2="20" y2="19"></line>
            </svg>
        );

        const Play = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
        );

        const Square = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            </svg>
        );

        const Trash2 = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        );

        const Upload = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        );

        const FolderOpen = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
        );

        const FileText = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
            </svg>
        );

        const Folder = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
        );

        const Archive = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="21 8 21 21 3 21 3 8"></polyline>
                <rect x="1" y="3" width="22" height="5"></rect>
            </svg>
        );

        const Download = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );

        const Save = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
            </svg>
        );

        const MoreVertical = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="12" cy="5" r="1"></circle>
                <circle cx="12" cy="19" r="1"></circle>
            </svg>
        );

        const ChevronRight = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );

        const Package = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
        );

        const X = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        function NodeTerminal() {
            const [isRunning, setIsRunning] = useState(false);
            const [output, setOutput] = useState([]);
            const [command, setCommand] = useState('');
            const [files, setFiles] = useState({});
            const [folders, setFolders] = useState({});
            const [currentFile, setCurrentFile] = useState('index.js');
            const [currentContent, setCurrentContent] = useState('');
            const [expandedFolders, setExpandedFolders] = useState({ '/': true });
            const [contextMenu, setContextMenu] = useState(null);
            const [selectedItem, setSelectedItem] = useState(null);
            const [showModal, setShowModal] = useState(null);
            const [modalInput, setModalInput] = useState('');
            const [installedPackages, setInstalledPackages] = useState({});
            const outputRef = useRef(null);

            useEffect(() => {
                loadFromStorage();
            }, []);

            useEffect(() => {
                if (outputRef.current) {
                    outputRef.current.scrollTop = outputRef.current.scrollHeight;
                }
            }, [output]);

            const loadFromStorage = () => {
                try {
                    const stored = localStorage.getItem('nodejs-files');
                    const storedFolders = localStorage.getItem('nodejs-folders');
                    const storedPackages = localStorage.getItem('nodejs-packages');
                    
                    if (stored) {
                        const filesData = JSON.parse(stored);
                        setFiles(filesData);
                    }
                    if (storedFolders) {
                        setFolders(JSON.parse(storedFolders));
                    }
                    if (storedPackages) {
                        setInstalledPackages(JSON.parse(storedPackages));
                    }
                    addOutput('Workspace loaded', 'success');
                } catch (err) {
                    addOutput('Starting fresh workspace', 'info');
                }
            };

            const saveToStorage = (filesData, foldersData, packagesData) => {
                try {
                    localStorage.setItem('nodejs-files', JSON.stringify(filesData || files));
                    localStorage.setItem('nodejs-folders', JSON.stringify(foldersData || folders));
                    if (packagesData) {
                        localStorage.setItem('nodejs-packages', JSON.stringify(packagesData));
                    }
                } catch (err) {
                    addOutput('Failed to save workspace', 'error');
                }
            };

            const addOutput = (text, type = 'output') => {
                setOutput(prev => [...prev, { text, type, timestamp: new Date().toLocaleTimeString() }]);
            };

            const handleZipUpload = async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                try {
                    addOutput(`Extracting ${file.name}...`, 'info');
                    
                    const zip = new JSZip();
                    const contents = await zip.loadAsync(file);
                    
                    const newFiles = { ...files };
                    const newFolders = { ...folders };
                    let extractedCount = 0;

                    for (const [path, zipEntry] of Object.entries(contents.files)) {
                        if (zipEntry.dir) {
                            newFolders[path] = true;
                        } else {
                            const content = await zipEntry.async('string');
                            newFiles[path] = content;
                            extractedCount++;
                            
                            const pathParts = path.split('/');
                            for (let i = 1; i < pathParts.length; i++) {
                                const folderPath = pathParts.slice(0, i).join('/') + '/';
                                newFolders[folderPath] = true;
                            }
                        }
                    }

                    setFiles(newFiles);
                    setFolders(newFolders);
                    saveToStorage(newFiles, newFolders);
                    
                    addOutput(`‚úì Extracted ${extractedCount} files`, 'success');
                    
                    const firstJsFile = Object.keys(newFiles).find(f => f.endsWith('.js'));
                    if (firstJsFile) {
                        setCurrentFile(firstJsFile);
                        setCurrentContent(newFiles[firstJsFile]);
                    }
                } catch (err) {
                    addOutput(`Error: ${err.message}`, 'error');
                }
            };

            const createNewFile = () => {
                setShowModal('newFile');
                setModalInput('');
            };

            const createNewFolder = () => {
                setShowModal('newFolder');
                setModalInput('');
            };

            const handleModalSubmit = () => {
                if (!modalInput.trim()) return;

                if (showModal === 'newFile') {
                    const newFiles = { ...files, [modalInput]: '' };
                    setFiles(newFiles);
                    setCurrentFile(modalInput);
                    setCurrentContent('');
                    saveToStorage(newFiles, folders);
                    addOutput(`‚úì Created: ${modalInput}`, 'success');
                } else if (showModal === 'newFolder') {
                    const folderPath = modalInput.endsWith('/') ? modalInput : modalInput + '/';
                    const newFolders = { ...folders, [folderPath]: true };
                    setFolders(newFolders);
                    saveToStorage(files, newFolders);
                    addOutput(`‚úì Created folder: ${folderPath}`, 'success');
                } else if (showModal === 'rename') {
                    handleRename(modalInput);
                } else if (showModal === 'move') {
                    handleMove(modalInput);
                } else if (showModal === 'npmInstall') {
                    handleNpmInstall(modalInput);
                }

                setShowModal(null);
                setModalInput('');
            };

            const handleRename = (newName) => {
                if (selectedItem.type === 'file') {
                    const newFiles = { ...files };
                    newFiles[newName] = newFiles[selectedItem.path];
                    delete newFiles[selectedItem.path];
                    setFiles(newFiles);
                    saveToStorage(newFiles, folders);
                    addOutput(`‚úì Renamed: ${selectedItem.path} ‚Üí ${newName}`, 'success');
                } else {
                    const newFolders = { ...folders };
                    newFolders[newName] = true;
                    delete newFolders[selectedItem.path];
                    setFolders(newFolders);
                    saveToStorage(files, newFolders);
                    addOutput(`‚úì Renamed folder: ${selectedItem.path} ‚Üí ${newName}`, 'success');
                }
            };

            const handleMove = (destination) => {
                if (selectedItem.type === 'file') {
                    const fileName = selectedItem.path.split('/').pop();
                    const newPath = destination.endsWith('/') ? destination + fileName : destination + '/' + fileName;
                    const newFiles = { ...files };
                    newFiles[newPath] = newFiles[selectedItem.path];
                    delete newFiles[selectedItem.path];
                    setFiles(newFiles);
                    saveToStorage(newFiles, folders);
                    addOutput(`‚úì Moved: ${selectedItem.path} ‚Üí ${newPath}`, 'success');
                }
            };

            const handleDelete = () => {
                if (selectedItem.type === 'file') {
                    const newFiles = { ...files };
                    delete newFiles[selectedItem.path];
                    setFiles(newFiles);
                    saveToStorage(newFiles, folders);
                    addOutput(`‚úì Deleted: ${selectedItem.path}`, 'success');
                } else {
                    const newFolders = { ...folders };
                    delete newFolders[selectedItem.path];
                    setFolders(newFolders);
                    saveToStorage(files, newFolders);
                    addOutput(`‚úì Deleted folder: ${selectedItem.path}`, 'success');
                }
                setContextMenu(null);
            };

            const zipFolder = async (folderPath) => {
                try {
                    const zip = new JSZip();
                    const folder = zip.folder(folderPath.replace('/', ''));
                    
                    Object.entries(files).forEach(([path, content]) => {
                        if (path.startsWith(folderPath)) {
                            const relativePath = path.substring(folderPath.length);
                            folder.file(relativePath, content);
                        }
                    });

                    const blob = await zip.generateAsync({ type: 'blob' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = folderPath.replace('/', '') + '.zip';
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    addOutput(`‚úì Zipped: ${folderPath}`, 'success');
                } catch (err) {
                    addOutput(`Error: ${err.message}`, 'error');
                }
            };

            const handleNpmInstall = (packageName) => {
                addOutput(`$ npm install ${packageName}`, 'command');
                addOutput(`Installing ${packageName}...`, 'info');
                
                setTimeout(() => {
                    const newPackages = { 
                        ...installedPackages, 
                        [packageName]: 'latest'
                    };
                    setInstalledPackages(newPackages);
                    saveToStorage(files, folders, newPackages);
                    
                    addOutput(`‚úì ${packageName}@latest installed`, 'success');
                    addOutput(`+ ${packageName}`, 'output');
                }, 500);
            };

            const saveCurrentFile = () => {
                const newFiles = { ...files, [currentFile]: currentContent };
                setFiles(newFiles);
                saveToStorage(newFiles, folders);
                addOutput(`‚úì Saved: ${currentFile}`, 'success');
            };

            const downloadAsZip = async () => {
                try {
                    const zip = new JSZip();

                    Object.entries(files).forEach(([path, content]) => {
                        zip.file(path, content);
                    });

                    const blob = await zip.generateAsync({ type: 'blob' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'project.zip';
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    addOutput('‚úì Project exported', 'success');
                } catch (err) {
                    addOutput(`Error: ${err.message}`, 'error');
                }
            };

            const executeCommand = (cmd) => {
                addOutput(`$ ${cmd}`, 'command');
                
                const parts = cmd.trim().split(' ');
                const mainCmd = parts[0];
                const args = parts.slice(1);

                try {
                    switch(mainCmd) {
                        case 'node':
                            if (args[0] && files[args[0]]) {
                                executeNodeScript(files[args[0]]);
                            } else {
                                addOutput(`Error: File '${args[0]}' not found`, 'error');
                            }
                            break;
                        
                        case 'npm':
                            if (args[0] === 'install' || args[0] === 'i') {
                                const pkg = args[1] || 'all packages';
                                if (args[1]) {
                                    handleNpmInstall(args[1]);
                                } else {
                                    addOutput('Installing dependencies...', 'info');
                                    addOutput('‚úì Dependencies installed', 'success');
                                }
                            } else if (args[0] === 'start') {
                                if (files['index.js']) {
                                    executeNodeScript(files['index.js']);
                                } else {
                                    addOutput('Error: index.js not found', 'error');
                                }
                            } else if (args[0] === 'list' || args[0] === 'ls') {
                                addOutput('Installed packages:', 'info');
                                Object.entries(installedPackages).forEach(([pkg, ver]) => {
                                    addOutput(`  ${pkg}@${ver}`, 'output');
                                });
                            } else {
                                addOutput(`npm ${args.join(' ')} executed`, 'info');
                            }
                            break;
                        
                        case 'ls':
                        case 'dir':
                            addOutput('Files and folders:', 'info');
                            Object.keys(folders).forEach(f => addOutput(`  üìÅ ${f}`, 'output'));
                            Object.keys(files).forEach(f => addOutput(`  üìÑ ${f}`, 'output'));
                            break;
                        
                        case 'cat':
                            if (files[args[0]]) {
                                addOutput(files[args[0]], 'output');
                            } else {
                                addOutput(`Error: ${args[0]} not found`, 'error');
                            }
                            break;
                        
                        case 'rm':
                            if (files[args[0]]) {
                                const newFiles = { ...files };
                                delete newFiles[args[0]];
                                setFiles(newFiles);
                                saveToStorage(newFiles, folders);
                                addOutput(`‚úì Removed: ${args[0]}`, 'success');
                            } else {
                                addOutput(`Error: ${args[0]} not found`, 'error');
                            }
                            break;
                        
                        case 'mkdir':
                            const folderPath = args[0].endsWith('/') ? args[0] : args[0] + '/';
                            const newFolders = { ...folders, [folderPath]: true };
                            setFolders(newFolders);
                            saveToStorage(files, newFolders);
                            addOutput(`‚úì Created: ${folderPath}`, 'success');
                            break;
                        
                        case 'clear':
                            setOutput([]);
                            break;
                        
                        case 'help':
                            addOutput('Available commands:', 'info');
                            addOutput('  node <file> - Run Node.js file', 'info');
                            addOutput('  npm install <pkg> - Install package', 'info');
                            addOutput('  npm start - Run index.js', 'info');
                            addOutput('  npm list - Show packages', 'info');
                            addOutput('  ls - List files', 'info');
                            addOutput('  cat <file> - Show content', 'info');
                            addOutput('  rm <file> - Delete file', 'info');
                            addOutput('  mkdir <name> - Create folder', 'info');
                            addOutput('  clear - Clear console', 'info');
                            break;
                        
                        default:
                            addOutput(`Command not found: ${mainCmd}`, 'error');
                    }
                } catch (error) {
                    addOutput(`Error: ${error.message}`, 'error');
                }
            };

            const executeNodeScript = (script) => {
                try {
                    addOutput('Starting Node.js process...', 'info');
                    
                    const logs = [];
                    const mockConsole = {
                        log: (...args) => logs.push(args.join(' ')),
                        error: (...args) => logs.push('ERROR: ' + args.join(' ')),
                        warn: (...args) => logs.push('WARN: ' + args.join(' '))
                    };
                    
                    const mockRequire = (module) => {
                        if (installedPackages[module]) {
                            mockConsole.log(`‚úì Loaded: ${module}`);
                            return {};
                        }
                        mockConsole.warn(`Module ${module} not installed`);
                        return {};
                    };
                    
                    const wrappedScript = `
                        (function() {
                            const console = mockConsole;
                            const require = mockRequire;
                            ${script}
                        })()
                    `;
                    
                    try {
                        eval(wrappedScript);
                        logs.forEach(log => addOutput(log, 'output'));
                        addOutput('‚úì Process completed (exit 0)', 'success');
                    } catch (err) {
                        addOutput(`Runtime Error: ${err.message}`, 'error');
                    }
                } catch (error) {
                    addOutput(`Execution Error: ${error.message}`, 'error');
                }
            };

            const handleStart = () => {
                if (!currentContent) {
                    addOutput('Error: No script loaded', 'error');
                    return;
                }
                setIsRunning(true);
                addOutput('=== Starting Process ===', 'info');
                executeNodeScript(currentContent);
                setIsRunning(false);
            };

            const renderFileTree = () => {
                const items = [];
                
                const sortedFolders = Object.keys(folders).sort();
                const sortedFiles = Object.keys(files).sort();
                
                sortedFolders.forEach(folder => {
                    const depth = (folder.match(/\//g) || []).length - 1;
                    const name = folder.split('/').filter(Boolean).pop() || folder;
                    const isExpanded = expandedFolders[folder];
                    
                    items.push(
                        <div key={folder} style={{ paddingLeft: `${depth * 16}px` }}>
                            <div
                                className="flex items-center gap-2 px-2 py-1.5 cursor-pointer file-tree-item rounded text-sm"
                                onClick={() => setExpandedFolders({ ...expandedFolders, [folder]: !isExpanded })}
                                onContextMenu={(e) => {
                                    e.preventDefault();
                                    setContextMenu({ x: e.clientX, y: e.clientY });
                                    setSelectedItem({ path: folder, type: 'folder' });
                                }}
                            >
                                <ChevronRight 
                                    size={14} 
                                    className={`transition-transform ${isExpanded ? 'rotate-90' : ''}`} 
                                />
                                <Folder size={16} className="text-blue-400" />
                                <span className="text-gray-300">{name}</span>
                            </div>
                        </div>
                    );
                });
                
                sortedFiles.forEach(file => {
                    const depth = (file.match(/\//g) || []).length;
                    const name = file.split('/').pop();
                    
                    items.push(
                        <div key={file} style={{ paddingLeft: `${depth * 16}px` }}>
                            <div
                                className={`flex items-center gap-2 px-2 py-1.5 cursor-pointer file-tree-item rounded text-sm ${
                                    currentFile === file ? 'bg-blue-600 text-white' : 'text-gray-300'
                                }`}
                                onClick={() => {
                                    setCurrentFile(file);
                                    setCurrentContent(files[file]);
                                }}
                                onContextMenu={(e) => {
                                    e.preventDefault();
                                    setContextMenu({ x: e.clientX, y: e.clientY });
                                    setSelectedItem({ path: file, type: 'file' });
                                }}
                            >
                                <FileText size={14} />
                                <span>{name}</span>
                            </div>
                        </div>
                    );
                });
                
                return items;
            };

            const loadExampleProject = () => {
                const exampleFiles = {
                    'index.js': `const express = require('express');
const app = express();

console.log('üöÄ Starting server...');

app.get('/', (req, res) => {
  res.json({ message: 'Hello World!' });
});

console.log('‚úì Server ready on port 3000');`,
                    
                    'src/utils.js': `function formatDate(date) {
  return date.toISOString();
}

module.exports = { formatDate };`,
                    
                    'package.json': `{
  "name": "nodejs-terminal",
  "version": "1.0.0",
  "main": "index.js",
  "dependencies": {
    "express": "^4.18.0"
  }
}`,
                    
                    'README.md': `# Node.js Project

Professional terminal interface`
                };
                
                const exampleFolders = { 'src/': true };
                const examplePackages = { 'express': '^4.18.0' };
                
                setFiles(exampleFiles);
                setFolders(exampleFolders);
                setInstalledPackages(examplePackages);
                setCurrentFile('index.js');
                setCurrentContent(exampleFiles['index.js']);
                saveToStorage(exampleFiles, exampleFolders, examplePackages);
                addOutput('‚úì Example project loaded', 'success');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 p-4">
                    <div className="max-w-[1920px] mx-auto">
                        {/* Header */}
                        <div className="bg-gradient-to-r from-gray-800 to-gray-900 rounded-t-xl p-5 border-b-2 border-blue-500 shadow-xl">
                            <div className="flex items-center justify-between flex-wrap gap-4">
                                <div className="flex items-center gap-4">
                                    <div className="bg-blue-600 p-3 rounded-lg">
                                        <Terminal size={32} className="text-white" />
                                    </div>
                                    <div>
                                        <h1 className="text-3xl font-bold text-white">Node.js Terminal Panel</h1>
                                        <p className="text-gray-400 text-sm mt-1">Professional Development Environment</p>
                                    </div>
                                </div>
                                <div className="flex gap-3 flex-wrap">
                                    <button
                                        onClick={handleStart}
                                        disabled={isRunning}
                                        className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 disabled:from-gray-600 disabled:to-gray-700 text-white rounded-lg transition-all shadow-lg font-semibold"
                                    >
                                        <Play size={18} />
                                        Start
                                    </button>
                                    <button
                                        onClick={() => setIsRunning(false)}
                                        disabled={!isRunning}
                                        className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 disabled:from-gray-600 disabled:to-gray-700 text-white rounded-lg transition-all shadow-lg font-semibold"
                                    >
                                        <Square size={18} />
                                        Stop
                                    </button>
                                    <button
                                        onClick={() => setOutput([])}
                                        className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white rounded-lg transition-all shadow-lg font-semibold"
                                    >
                                        <Trash2 size={18} />
                                        Clear
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 xl:grid-cols-5 gap-4 mt-4">
                            {/* File Explorer */}
                            <div className="xl:col-span-1 bg-gray-800 rounded-xl shadow-2xl border border-gray-700 animate-slide-in">
                                <div className="p-4 border-b border-gray-700 bg-gradient-to-r from-gray-800 to-gray-900">
                                    <h2 className="text-lg font-bold text-white flex items-center gap-2">
                                        <FolderOpen size={20} className="text-blue-400" />
                                        File Explorer
                                    </h2>
                                </div>
                                
                                <div className="p-3 space-y-2">
                                    <label className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white text-sm rounded-lg cursor-pointer transition-all shadow-md font-semibold w-full justify-center">
                                        <Archive size={16} />
                                        Import ZIP
                                        <input type="file" accept=".zip" onChange={handleZipUpload} className="hidden" />
                                    </label>
                                    
                                    <button
                                        onClick={createNewFile}
                                        className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white text-sm rounded-lg transition-all shadow-md font-semibold w-full justify-center"
                                    >
                                        <FileText size={16} />
                                        New File
                                    </button>
                                    
                                    <button
                                        onClick={createNewFolder}
                                        className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white text-sm rounded-lg transition-all shadow-md font-semibold w-full justify-center"
                                    >
                                        <Folder size={16} />
                                        New Folder
                                    </button>
                                    
                                    <button
                                        onClick={() => { setShowModal('npmInstall'); setModalInput(''); }}
                                        className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white text-sm rounded-lg transition-all shadow-md font-semibold w-full justify-center"
                                    >
                                        <Package size={16} />
                                        NPM Install
                                    </button>
                                    
                                    <button
                                        onClick={downloadAsZip}
                                        className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white text-sm rounded-lg transition-all shadow-md font-semibold w-full justify-center"
                                    >
                                        <Download size={16} />
                                        Export ZIP
                                    </button>
                                    
                                    <button
                                        onClick={loadExampleProject}
                                        className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white text-sm rounded-lg transition-all shadow-md font-semibold w-full justify-center"
                                    >
                                        <FolderOpen size={16} />
                                        Load Example
                                    </button>
                                </div>

                                <div className="border-t border-gray-700 p-3">
                                    <div className="text-xs text-gray-400 mb-3 font-bold uppercase tracking-wider">Workspace</div>
                                    <div className="space-y-1 max-h-[600px] overflow-y-auto">
                                        {Object.keys(files).length === 0 && Object.keys(folders).length === 0 ? (
                                            <div className="text-gray-500 text-sm py-4 text-center">
                                                <FolderOpen size={32} className="mx-auto mb-2 opacity-50" />
                                                No files yet
                                            </div>
                                        ) : (
                                            renderFileTree()
                                        )}
                                    </div>
                                </div>

                                {/* Installed Packages */}
                                {Object.keys(installedPackages).length > 0 && (
                                    <div className="border-t border-gray-700 p-3">
                                        <div className="text-xs text-gray-400 mb-2 font-bold uppercase tracking-wider">Packages</div>
                                        <div className="space-y-1">
                                            {Object.entries(installedPackages).map(([pkg, ver]) => (
                                                <div key={pkg} className="flex items-center gap-2 px-2 py-1 text-xs text-gray-300 bg-gray-900 rounded">
                                                    <Package size={12} className="text-green-400" />
                                                    <span>{pkg}</span>
                                                    <span className="ml-auto text-gray-500">{ver}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Main Content */}
                            <div className="xl:col-span-4 space-y-4">
                                {/* Code Editor */}
                                <div className="bg-gray-800 rounded-xl shadow-2xl border border-gray-700 animate-slide-in">
                                    <div className="flex items-center justify-between p-4 border-b border-gray-700 bg-gradient-to-r from-gray-800 to-gray-900">
                                        <h2 className="text-lg font-bold text-white flex items-center gap-2">
                                            <FileText size={20} className="text-green-400" />
                                            <span className="text-gray-400">Editor:</span>
                                            <span className="text-blue-400">{currentFile}</span>
                                        </h2>
                                        <button
                                            onClick={saveCurrentFile}
                                            className="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white text-sm rounded-lg transition-all shadow-md font-semibold"
                                        >
                                            <Save size={16} />
                                            Save
                                        </button>
                                    </div>
                                    <div className="p-4">
                                        <textarea
                                            value={currentContent}
                                            onChange={(e) => setCurrentContent(e.target.value)}
                                            className="w-full h-80 bg-gray-900 text-gray-300 font-mono text-sm p-4 rounded-lg border-2 border-gray-700 focus:border-blue-500 focus:outline-none resize-none shadow-inner"
                                            placeholder="// Select or create a file to start coding..."
                                            spellCheck="false"
                                        />
                                    </div>
                                </div>

                                {/* Console */}
                                <div className="bg-gray-800 rounded-xl shadow-2xl border border-gray-700 animate-slide-in">
                                    <div className="flex items-center justify-between p-4 border-b border-gray-700 bg-gradient-to-r from-gray-800 to-gray-900">
                                        <h2 className="text-lg font-bold text-white flex items-center gap-2">
                                            <Terminal size={20} className="text-green-400" />
                                            Console
                                            {isRunning && (
                                                <span className="ml-3 text-xs bg-green-600 text-white px-3 py-1 rounded-full animate-pulse font-semibold">
                                                    ‚óè Running
                                                </span>
                                            )}
                                        </h2>
                                    </div>
                                    <div className="p-4">
                                        <div
                                            ref={outputRef}
                                            className="bg-black rounded-lg border-2 border-gray-700 p-4 h-72 overflow-y-auto font-mono text-sm shadow-inner"
                                        >
                                            {output.length === 0 ? (
                                                <div className="text-gray-500">
                                                    <div className="text-green-400 font-bold">Node.js Web Terminal v2.0.0</div>
                                                    <div className="mt-2">Ready to execute commands...</div>
                                                    <div className="mt-1">Type 'help' for available commands</div>
                                                </div>
                                            ) : (
                                                output.map((line, i) => (
                                                    <div key={i} className={`mb-1 ${
                                                        line.type === 'command' ? 'text-blue-400 font-bold' :
                                                        line.type === 'error' ? 'text-red-400' :
                                                        line.type === 'success' ? 'text-green-400' :
                                                        line.type === 'info' ? 'text-yellow-400' :
                                                        'text-gray-300'
                                                    }`}>
                                                        <span className="text-gray-600 text-xs mr-2">[{line.timestamp}]</span>
                                                        {line.text}
                                                    </div>
                                                ))
                                            )}
                                        </div>

                                        <div className="mt-4 flex gap-2">
                                            <input
                                                type="text"
                                                value={command}
                                                onChange={(e) => setCommand(e.target.value)}
                                                onKeyPress={(e) => {
                                                    if (e.key === 'Enter' && command.trim()) {
                                                        executeCommand(command);
                                                        setCommand('');
                                                    }
                                                }}
                                                placeholder="$ node index.js | npm install | help"
                                                className="flex-1 bg-gray-900 text-gray-300 px-4 py-3 rounded-lg border-2 border-gray-700 focus:border-blue-500 focus:outline-none font-mono text-sm shadow-inner"
                                            />
                                            <button
                                                onClick={() => {
                                                    if (command.trim()) {
                                                        executeCommand(command);
                                                        setCommand('');
                                                    }
                                                }}
                                                className="px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all shadow-lg font-semibold"
                                            >
                                                Execute
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Context Menu */}
                    {contextMenu && (
                        <>
                            <div 
                                className="fixed inset-0 z-40" 
                                onClick={() => setContextMenu(null)}
                            />
                            <div
                                className="fixed bg-gray-800 rounded-lg shadow-2xl border border-gray-700 py-2 z-50 context-menu min-w-48"
                                style={{ top: contextMenu.y, left: contextMenu.x }}
                            >
                                <button
                                    onClick={() => {
                                        setShowModal('rename');
                                        setModalInput(selectedItem.path);
                                        setContextMenu(null);
                                    }}
                                    className="w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-gray-700 transition-colors"
                                >
                                    Rename
                                </button>
                                {selectedItem?.type === 'file' && (
                                    <button
                                        onClick={() => {
                                            setShowModal('move');
                                            setModalInput('');
                                            setContextMenu(null);
                                        }}
                                        className="w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-gray-700 transition-colors"
                                    >
                                        Move
                                    </button>
                                )}
                                {selectedItem?.type === 'folder' && (
                                    <button
                                        onClick={() => {
                                            zipFolder(selectedItem.path);
                                            setContextMenu(null);
                                        }}
                                        className="w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-gray-700 transition-colors"
                                    >
                                        Zip Folder
                                    </button>
                                )}
                                <button
                                    onClick={handleDelete}
                                    className="w-full px-4 py-2 text-left text-sm text-red-400 hover:bg-gray-700 transition-colors"
                                >
                                    Delete
                                </button>
                            </div>
                        </>
                    )}

                    {/* Modal */}
                    {showModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
                            <div className="bg-gray-800 rounded-xl shadow-2xl border-2 border-gray-700 p-6 max-w-md w-full">
                                <div className="flex items-center justify-between mb-4">
                                    <h3 className="text-xl font-bold text-white">
                                        {showModal === 'newFile' && 'Create New File'}
                                        {showModal === 'newFolder' && 'Create New Folder'}
                                        {showModal === 'rename' && 'Rename'}
                                        {showModal === 'move' && 'Move File'}
                                        {showModal === 'npmInstall' && 'Install Package'}
                                    </h3>
                                    <button
                                        onClick={() => setShowModal(null)}
                                        className="text-gray-400 hover:text-white transition-colors"
                                    >
                                        <X size={24} />
                                    </button>
                                </div>
                                <input
                                    type="text"
                                    value={modalInput}
                                    onChange={(e) => setModalInput(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleModalSubmit()}
                                    placeholder={
                                        showModal === 'newFile' ? 'e.g., server.js' :
                                        showModal === 'newFolder' ? 'e.g., src/' :
                                        showModal === 'rename' ? 'New name' :
                                        showModal === 'move' ? 'Destination folder' :
                                        'e.g., express'
                                    }
                                    className="w-full bg-gray-900 text-gray-300 px-4 py-3 rounded-lg border-2 border-gray-700 focus:border-blue-500 focus:outline-none mb-4"
                                    autoFocus
                                />
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setShowModal(null)}
                                        className="flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors font-semibold"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        onClick={handleModalSubmit}
                                        className="flex-1 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all shadow-lg font-semibold"
                                    >
                                        Confirm
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<NodeTerminal />, document.getElementById('root'));
    </script>
</body>
</html>